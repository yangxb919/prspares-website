# æœ¬åœ°æµ‹è¯•æŒ‡å—

## ğŸ“‹ ä¸ºä»€ä¹ˆéœ€è¦æœ¬åœ°æµ‹è¯•ï¼Ÿ

ä¹‹å‰é‡åˆ°çš„æ‰€æœ‰é”™è¯¯ï¼ˆç¼ºå°‘ä¾èµ–ã€TypeScript ç±»å‹é”™è¯¯ã€ESLint é…ç½®é”™è¯¯ç­‰ï¼‰**åœ¨æœ¬åœ°å’Œ VPS éƒ½ä¼šå‡ºç°**ã€‚

é€šè¿‡åœ¨æœ¬åœ°å…ˆæµ‹è¯•ï¼Œå¯ä»¥ï¼š
- âœ… é¿å…åå¤ push å’Œ pull
- âœ… èŠ‚çœ VPS éƒ¨ç½²æ—¶é—´
- âœ… æ›´å¿«å‘ç°å’Œä¿®å¤é—®é¢˜
- âœ… ä¿æŒ Git å†å²å¹²å‡€

---

## ğŸš€ æ–¹æ³• 1ï¼šæ‰‹åŠ¨æµ‹è¯•ï¼ˆæ¨èï¼‰

åœ¨æ¯æ¬¡ push ä¹‹å‰è¿è¡Œï¼š

```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬
./scripts/test-before-push.sh
```

è¿™ä¸ªè„šæœ¬ä¼šä¾æ¬¡è¿è¡Œï¼š
1. **TypeScript ç±»å‹æ£€æŸ¥** - æ£€æŸ¥ç±»å‹é”™è¯¯
2. **ESLint ä»£ç æ£€æŸ¥** - æ£€æŸ¥ä»£ç è§„èŒƒ
3. **æ„å»ºæµ‹è¯•** - å®Œæ•´æ„å»ºé¡¹ç›®

å¦‚æœæ‰€æœ‰æµ‹è¯•éƒ½é€šè¿‡ï¼Œå°±å¯ä»¥å®‰å…¨ push äº†ï¼

---

## ğŸ”§ æ–¹æ³• 2ï¼šåˆ†æ­¥æµ‹è¯•

å¦‚æœä½ æƒ³å•ç‹¬è¿è¡ŒæŸä¸ªæµ‹è¯•ï¼š

```bash
# 1. ç±»å‹æ£€æŸ¥
npm run type-check

# 2. ESLint æ£€æŸ¥
npm run lint

# 3. æ„å»ºæµ‹è¯•
npm run build:fast

# 4. å®Œæ•´æ„å»ºï¼ˆåŒ…å«å›¾ç‰‡ä¼˜åŒ–ï¼‰
npm run build
```

---

## ğŸ“ å®Œæ•´å·¥ä½œæµç¨‹

```bash
# 1. ä¿®æ”¹ä»£ç 
# ... ç¼–è¾‘æ–‡ä»¶ ...

# 2. æœ¬åœ°æµ‹è¯•
./scripts/test-before-push.sh

# 3. å¦‚æœæµ‹è¯•é€šè¿‡ï¼Œæäº¤ä»£ç 
git add -A
git commit -m "ä½ çš„æäº¤ä¿¡æ¯"

# 4. Push åˆ° GitHub
git push origin master

# 5. åœ¨ VPS ä¸Šéƒ¨ç½²
ssh root@your_vps_ip
cd /var/www/prspares-website
git pull origin master
npm install  # å¦‚æœæœ‰æ–°ä¾èµ–
npm run build:fast
pm2 restart prspares
```

---

## âš¡ å¿«é€Ÿå‘½ä»¤

```bash
# æµ‹è¯• + æäº¤ + Pushï¼ˆä¸€è¡Œå‘½ä»¤ï¼‰
./scripts/test-before-push.sh && git add -A && git commit -m "ä½ çš„æäº¤ä¿¡æ¯" && git push origin master
```

---

## ğŸ¯ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆæœ¬åœ° `npm run dev` æ­£å¸¸ï¼Œä½†æ„å»ºå¤±è´¥ï¼Ÿ

A: å› ä¸ºå¼€å‘æ¨¡å¼ï¼ˆ`npm run dev`ï¼‰ä¸ä¼šè¿›è¡Œå®Œæ•´çš„ç±»å‹æ£€æŸ¥å’Œ ESLint æ£€æŸ¥ã€‚åªæœ‰ `npm run build` æ‰ä¼šã€‚

### Q: å¦‚ä½•è·³è¿‡æµ‹è¯•ç›´æ¥ pushï¼Ÿ

A: å¯ä»¥ï¼Œä½†ä¸æ¨èã€‚å¦‚æœç¡®å®éœ€è¦ï¼š
```bash
git push origin master --no-verify
```

### Q: æµ‹è¯•è„šæœ¬åœ¨å“ªé‡Œï¼Ÿ

A: åœ¨ `scripts/test-before-push.sh`

### Q: å¦‚ä½•å¯ç”¨è‡ªåŠ¨ Git hooksï¼Ÿ

A: ç¼–è¾‘ `.husky/pre-push` æ–‡ä»¶ï¼Œå–æ¶ˆæ³¨é‡Šæ£€æŸ¥å‘½ä»¤ã€‚

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| æ–¹å¼ | æ—¶é—´ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|------|
| **æœ¬åœ°æµ‹è¯•å push** | æœ¬åœ° 2-3 åˆ†é’Ÿ + VPS 4-6 åˆ†é’Ÿ | ä¸€æ¬¡æˆåŠŸï¼ŒèŠ‚çœæ—¶é—´ | éœ€è¦æ‰‹åŠ¨è¿è¡Œ |
| **ç›´æ¥ push åˆ° VPS** | VPS 15-20 åˆ†é’Ÿï¼ˆå¯èƒ½å¤±è´¥å¤šæ¬¡ï¼‰ | ç®€å• | æµªè´¹æ—¶é—´ï¼Œåå¤è°ƒè¯• |

---

## âœ… æœ€ä½³å®è·µ

1. **æ¯æ¬¡ä¿®æ”¹ä»£ç å**ï¼Œå…ˆè¿è¡Œ `./scripts/test-before-push.sh`
2. **åªæœ‰æµ‹è¯•é€šè¿‡å**ï¼Œæ‰ push åˆ° GitHub
3. **å®šæœŸè¿è¡Œ** `npm run build` ç¡®ä¿å®Œæ•´æ„å»ºæ­£å¸¸
4. **æ·»åŠ æ–°ä¾èµ–å**ï¼Œè®°å¾—åœ¨ VPS ä¸Šè¿è¡Œ `npm install`

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

- `scripts/test-before-push.sh` - æµ‹è¯•è„šæœ¬
- `.husky/pre-push` - Git pre-push hookï¼ˆé»˜è®¤ç¦ç”¨ï¼‰
- `package.json` - åŒ…å«æ‰€æœ‰æµ‹è¯•å‘½ä»¤
- `.eslintrc.json` - ESLint é…ç½®

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œæ£€æŸ¥ï¼š
1. æ˜¯å¦è¿è¡Œäº† `npm install`
2. æ˜¯å¦æœ‰ `.env.local` æ–‡ä»¶
3. Node.js ç‰ˆæœ¬æ˜¯å¦æ­£ç¡®ï¼ˆå»ºè®® 18.x æˆ–æ›´é«˜ï¼‰

